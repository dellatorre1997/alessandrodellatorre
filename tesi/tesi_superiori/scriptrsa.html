<html>
  <head>
  <title>CodRSA</title>
  <style type="text/css">
    body{
      background-color:black;
      color:white;
    }
    h1{
      text-align:center;
      font-size: 600%;
      color:#1569C7;
    }
    pre{
      margin-left: 30%;
      font-size:110%;
    }
    p{
      text-align: center;
    }
    a{
      color:white;
      text-align:center;
    }
    a:hover{
      color:blue;
    }
  </style>
  </head>
  <body>
  <h1>Sorgente RSA</h1>
  <p style="margin-top:-2%;"><b>Questo codice sorgente scritto in phyton e un esempio di funzionamento della crittografia RSA.</b></p>
  <br>
    <pre>
    import os           #importazioni
    from cryptography.hazmat.backends import default_backend
    from cryptography.hazmat.primitives.asymmetric import rsa
    from cryptography.hazmat.primitives import serialization
    from cryptography.hazmat.primitives import hashes
    from cryptography.hazmat.primitives.asymmetric import padding
    private_key = rsa.generate_private_key( # funzione creare chiave privata
      public_exponent=65537,
      key_size=2048,#chiave da due byte
      backend=default_backend()
    )
    public_key = private_key.public_key() #funzione crea chiave pubblica
      pem = public_key.public_bytes(
      encoding=serialization.Encoding.PEM,
      format=serialization.PublicFormat.SubjectPublicKeyInfo
    )
    pem.splitlines()[0]

    #encription

    message = b"encrypted data" #messaggio da criptare
    ciphertext = public_key.encrypt( #fuzione per crittare il messaggio
      message,
      padding.OAEP(
        mgf=padding.MGF1(algorithm=hashes.SHA1()),
        algorithm=hashes.SHA1(),
        label=None
        )
    )
    print(ciphertext)#stampo il messaggio crittato

    #decription

    plaintext = private_key.decrypt( #funzione decriptare il messaggio
      ciphertext,
      padding.OAEP(
        mgf=padding.MGF1(algorithm=hashes.SHA1()),
        algorithm=hashes.SHA1(),
        label=None
        )
    )
    print(plaintext)#funzione stampa del messaggio decriptato sotto forma normale
    </pre>
  <p margin-top="0"><b><a href="http://alessandrodt.altervista.org/tesina/index.html#/6/2">torna alla presentazione</a></b></p>
  </body>
</html>
